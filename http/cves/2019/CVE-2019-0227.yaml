id: CVE-2019-0227

info:
  name: CVE-2019-0227 - Server Side Request Forgery (SSRF) vulnerability
  author: Autobahn Security
  severity: high
  description: |
    A Server Side Request Forgery (SSRF) vulnerability affected the Apache Axis 1.4 distribution that was last released in 2006. Security and bug commits commits continue in the projects Axis 1.x Subversion repository, legacy users are encouraged to build from source. The successor to Axis 1.x is Axis2, the latest version is 1.7.9 and is not vulnerable to this issue.
  reference:
    - https://axis.apache.org/
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-0227
  metadata:
    shodan-query:
      - http.title:"Apache-AXIS"
  tags: tech,apache,axis,cve,cve2019

variables:
  vulnerable_version: 1.4

requests:
  - method: GET
    path:
      - "{{BaseURL}}/services/Version?method=getVersion"
      - "{{BaseURL}}/axis/services/Version?method=getVersion"

    host-redirects: true
    max-redirects: 2

    extractors:
      - type: regex
        part: body
        internal: true
        group: 1
        name: detected_version
        regex:
          - "Apache Axis version: ([0-9.]+)"

      - type: regex
        part: body
        group: 1
        regex:
          - "Apache Axis version: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - 'Apache Axis'
          - 'getVersionReturn'
        case-insensitive: false

      - type: dsl
        name: "outdated_version"
        dsl:
          - compare_versions(detected_version, concat('<= ', vulnerable_version))
